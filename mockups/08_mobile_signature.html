<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚µã‚¤ãƒ³å–å¾— - ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ç”¨ãƒ¢ãƒã‚¤ãƒ«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: #f5f5f5;
            max-width: 414px;
            margin: 0 auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .mobile-header {
            background: #2196F3;
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .back-btn {
            font-size: 20px;
            cursor: pointer;
        }
        .header-title {
            font-size: 18px;
            font-weight: 600;
        }
        .info-section {
            background: white;
            padding: 20px;
            border-bottom: 2px solid #e0e0e0;
        }
        .location-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }
        .receiver-name {
            font-size: 14px;
            color: #666;
        }
        .instruction {
            background: #fff3e0;
            padding: 15px;
            margin: 0;
            text-align: center;
        }
        .instruction-text {
            font-size: 14px;
            color: #f57c00;
            line-height: 1.6;
        }
        .canvas-container {
            flex: 1;
            background: white;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .canvas-wrapper {
            flex: 1;
            border: 2px dashed #2196F3;
            border-radius: 8px;
            position: relative;
            background: #fafafa;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #signatureCanvas {
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }
        .placeholder-text {
            position: absolute;
            color: #bbb;
            font-size: 16px;
            pointer-events: none;
        }
        .canvas-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .btn-clear {
            flex: 1;
            padding: 12px;
            background: white;
            color: #f44336;
            border: 2px solid #f44336;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }
        .btn-complete {
            flex: 2;
            padding: 12px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
        }
        .notice {
            background: white;
            padding: 15px;
            text-align: center;
            border-top: 1px solid #e0e0e0;
        }
        .notice-text {
            font-size: 12px;
            color: #666;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="mobile-header">
        <div class="back-btn">â†</div>
        <div class="header-title">ã‚µã‚¤ãƒ³å–å¾—</div>
    </div>

    <!-- é…é€å…ˆãƒ»å—é ˜è€…æƒ…å ± -->
    <div class="info-section">
        <div class="location-name">é…é€å…ˆ: ä¸­é‡å€‰åº«</div>
        <div class="receiver-name">å—é ˜è€…: ç”°ä¸­ ä¸€éƒ</div>
    </div>

    <!-- æŒ‡ç¤º -->
    <div class="instruction">
        <p class="instruction-text">
            ä¸‹è¨˜ã«ã‚µã‚¤ãƒ³ã‚’ãŠé¡˜ã„ã—ã¾ã™<br>
            æŒ‡ã§ã‚µã‚¤ãƒ³æ¬„ã«ç½²åã—ã¦ãã ã•ã„
        </p>
    </div>

    <!-- ã‚µã‚¤ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹ -->
    <div class="canvas-container">
        <div class="canvas-wrapper">
            <canvas id="signatureCanvas"></canvas>
            <div class="placeholder-text" id="placeholder">ã“ã“ã«ã‚µã‚¤ãƒ³ã—ã¦ãã ã•ã„</div>
        </div>
        <div class="canvas-actions">
            <button class="btn-clear" id="clearBtn">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
            <button class="btn-complete" id="completeBtn">âœ“ å®Œäº†</button>
        </div>
    </div>

    <!-- æ³¨æ„æ›¸ã -->
    <div class="notice">
        <p class="notice-text">
            â€» ã“ã®ã‚µã‚¤ãƒ³ã¯é…é€å®Œäº†ã®è¨¼æ˜ã¨ãªã‚Šã¾ã™<br>
            å—é ˜è€…ã”æœ¬äººã®ç½²åã‚’ãŠé¡˜ã„ã—ã¾ã™
        </p>
    </div>

    <script>
        // ã‚­ãƒ£ãƒ³ãƒã‚¹è¨­å®š
        const canvas = document.getElementById('signatureCanvas');
        const ctx = canvas.getContext('2d');
        const placeholder = document.getElementById('placeholder');
        let isDrawing = false;
        let hasSignature = false;

        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚µã‚¤ã‚ºè¨­å®š
        function resizeCanvas() {
            const wrapper = canvas.parentElement;
            canvas.width = wrapper.clientWidth - 4;
            canvas.height = wrapper.clientHeight - 4;
            
            // æç”»è¨­å®š
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // æç”»å‡¦ç†
        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            ctx.beginPath();
            ctx.moveTo(x, y);
            
            if (!hasSignature) {
                hasSignature = true;
                placeholder.style.display = 'none';
            }
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼ˆãƒã‚¦ã‚¹ï¼‰
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼ˆã‚¿ãƒƒãƒï¼‰
        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDrawing);

        // ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³
        document.getElementById('clearBtn').addEventListener('click', () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            hasSignature = false;
            placeholder.style.display = 'block';
        });

        // å®Œäº†ãƒœã‚¿ãƒ³
        document.getElementById('completeBtn').addEventListener('click', () => {
            if (!hasSignature) {
                alert('ã‚µã‚¤ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            // ã‚µã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const signatureData = canvas.toDataURL('image/png');
            console.log('Signature saved:', signatureData);
            
            // å‰ã®ç”»é¢ã«æˆ»ã‚‹ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ï¼‰
            alert('ã‚µã‚¤ãƒ³ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
            // window.history.back();
        });

        // æˆ»ã‚‹ãƒœã‚¿ãƒ³
        document.querySelector('.back-btn').addEventListener('click', () => {
            if (hasSignature) {
                if (confirm('å…¥åŠ›ã—ãŸã‚µã‚¤ãƒ³ãŒç ´æ£„ã•ã‚Œã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                    window.history.back();
                }
            } else {
                window.history.back();
            }
        });
    </script>
</body>
</html>
